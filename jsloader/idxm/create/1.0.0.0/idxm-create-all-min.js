Ext.namespace("IDXM.CreateUser.ClientUser.Step1");IDXM.CreateUser.ClientUser.Step1=function(c){if(c.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilderPlain(c.breadCrumbsDivID,c.navigator.breadCrumbs)}Ext.get(document.body.id).unmask();function a(){var f=d.getForm();var m=f.getValues();var k=true;if(Ext.isEmpty(m.accountNotificationEmailIndicator)){if(!Ext.form.VTypes.email(m.userID)){k=false;var h=d.find("name","userID");h[0].markInvalid('This field should be an e-mail address in the format "user@example.com"')}}if(k){if(f.isValid()){Ext.getCmp("nextButton").disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");var g=Wizard.PortalContainer.getActionURL("clientUserValidate");f.submit({url:g,isMessageIgnore:true,success:function(p,q){g_hideStatusBox();var n=uRadixUtilities.jsonDecode(q.response.responseText);if(n.messages.inputFields){for(var o=0;o<n.messages.inputFields.length;o++){if(n.messages.inputFields[o].faultID=="5001"){uRadixClientMessageHandler.setMessage=function(r,s){return}}}}var e=uRadixUtilities.jsonDecode(q.response.responseText).navigator;Wizard.PortalContainer.navigate({url:e.nextAction})},failure:function(p,q){Ext.getCmp("nextButton").enable();Ext.get(document.body.id).unmask();var n=uRadixUtilities.jsonDecode(q.response.responseText);if(n.messages.inputFields){for(var o=0;o<n.messages.inputFields.length;o++){if(n.messages.inputFields[o].fieldID=="likeUsersList"){var e=n.navigator;Wizard.PortalContainer.navigate({url:e.nextAction})}}}if((n.advice!=undefined)&&(n.advice!=null)){g_showStatusBox()}}})}else{try{console.log("Client form panel is NOT valid")}catch(l){}}}}Ext.form.Field.prototype.msgTarget="sideDetails";var d=new uRadix.form.FormPanel({title:"Create Client User",renderTo:c.formPanelDivID,ctCls:"support-portal-panel",width:850,bodyBorder:false,border:false,buttonAlign:"right",items:[{xtype:"hidden",name:"userTypeCode",value:IDXM_USER_TYPE_PERSON},{xtype:"hidden",name:"userClassCode",value:IDXM_USER_CLASS_CLIENT},{xtype:"hidden",name:"userSubClassCode",value:IDXM_USER_SUB_CLASS_CLIENT_TPA},{id:"idxmMirroredUserHeader",hidden:true},{xtype:"panel",border:false,bodyBorder:false,hideBorders:true,height:10},{xtype:"idxmUserDatePanel",id:"idxmUserDatePanel"+c.nameSpace,width:850,ctCls:"support-portal-panel-no-frame"},{xtype:"idxmClientGroupsRolesCCodes",id:"clientGroupsRolesCCodes"+c.nameSpace,width:"850",hidden:(c.mirroredUser&&(c.mirroredUser!=""))?true:false},{xtype:"idxmClientFieldsPanel",id:"clientSingleFieldsPanel"+c.nameSpace,width:"850"}],buttons:[{id:"nextButton",text:"NEXT",ctCls:"support-portal-btn",handler:a}],listeners:{uradix_enterkey:a}});if(c.userData){d.getForm().setValues(c.userData);d.getForm().clearInvalid()}if(c.mirroredUser&&(c.mirroredUser!="")){var b=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");b.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,c.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}};Ext.namespace("IDXM.CreateUser.ClientUser.Step2");IDXM.CreateUser.ClientUser.Step2=function(w){var g=IDXM.clientSingleUserTemplate(w.userData);if(w.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilder(w.breadCrumbsDivID,w.navigator.breadCrumbs)}Ext.get(document.body.id).unmask();var x=new Ext.Panel({bodyBorder:false,border:false,style:"padding-left:10px;",frame:false,autoScroll:true,width:220,height:404,html:g});var h=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Name & Information"},{xtype:"tbfill"}]});var s=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Groups"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(w.mirroredUser&&(w.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["groupPicker"+w.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=w.thisObjectName+".groupPickerCallBack";uRadixWindowManager.launch({id:"groupPicker"+w.nameSpace,key:"groupPicker"+w.nameSpace})}}]});var a=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Roles"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(w.mirroredUser&&(w.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["rolePicker"+w.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=w.thisObjectName+".rolePickerPickerCallBack";uRadixWindowManager.launch({id:"rolePicker"+w.nameSpace,key:"rolePicker"+w.nameSpace})}}]});var t={};var l="";if(w.userData.blnAllChildCCodes=="on"){l=" <span class='idxmTextSmall'>& all children</span>"}else{t={xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(w.mirroredUser&&(w.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["ccodePicker"+w.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=w.thisObjectName+".ccodePickerPickerCallBack";uRadixWindowManager.launch({id:"ccodePicker"+w.nameSpace,key:"ccodePicker"+w.nameSpace})}}}var u=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Access CCodes"},{xtype:"tbfill"},t]});var p=new Ext.tree.TreeNode({id:"groupsTreeRootID"+w.nameSpace,text:"Groups",draggable:false,leaf:false});if(w.defaultGroups){p.appendChild(w.defaultGroups)}var v=new Ext.tree.TreePanel({id:"ViewTtreePanelGroupID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,height:400,width:235,autoScroll:true,autoShow:true,rootVisible:false,containerScroll:true,root:p});var y=new Ext.tree.TreeNode({id:"rolesTreeRootID"+w.nameSpace,text:"Roles",draggable:false,leaf:false});if(w.defaultRoles){y.appendChild(w.defaultRoles)}var b=new Ext.tree.TreePanel({id:"ViewTtreePanelRoleID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,height:400,width:235,autoScroll:true,autoShow:true,rootVisible:false,containerScroll:true,root:y});var k=new Ext.tree.TreeNode({id:"ccodesTreeRootID"+w.nameSpace,text:"MultiPlan CCodes",draggable:false,leaf:false});if(w.userData.blnAllChildCCodes=="on"){k.appendChild([{id:w.userData.ccodeParent,leaf:true,text:w.userData.ccodeParent.toUpperCase()+l}])}else{if(w.ccodeTreeWithoutCheckedAttr){for(var q=0;q<w.ccodeTreeWithoutCheckedAttr.length;q++){k.appendChild(w.ccodeTreeWithoutCheckedAttr[q])}}}var f=new Ext.tree.TreePanel({id:"ViewTtreePanelRoleID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,height:400,width:235,autoScroll:true,autoShow:true,rootVisible:true,containerScroll:true,root:k});var n=new Ext.Panel({layout:"column",bodyBorder:false,border:false,hideBorders:true,width:990,style:"padding-top:10px; padding-bottom:10px;",ctCls:"support-portal-panel-head-frame",items:[{width:10,html:"&nbsp;"},{width:235,ctCls:"support-portal-panel-head-frame",items:[h,x]},{width:10,html:"&nbsp;"},{width:735,ctCls:"support-portal-panel-head-frame",items:[{xtype:"panel",layout:"column",autoScroll:true,items:[{width:240,items:[u,f]},{width:5,html:"&nbsp;"},{width:240,items:[s,v]},{width:5,html:"&nbsp;"},{width:240,items:[a,b]}]}]},{width:10,html:"&nbsp;"}]});function o(){var A=d.getForm();if(A.isValid()){var B=Wizard.PortalContainer.getActionURL("userCreateSubmit");var D=A.getValues();Ext.getCmp("saveBtn"+w.nameSpace).disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");A.submit({url:B,isMessageIgnore:true,isRedirect:true,success:function(G,H){var E=H.response.responseText;var e=uRadixUtilities.jsonDecode(H.response.responseText);if(e.payload&&e.payload!="null"){var F=uRadixUtilities.jsonDecode(e.payload);uRadixRedirectHandler.redirect(w.userProfileAdministrationURL+"?systemUserId="+F.primaryIdentityIdentifier.sysKey+"&fromUserCreate=true")}},failure:function(e,E){Ext.getCmp("saveBtn"+w.nameSpace).enable();Ext.get(document.body.id).unmask();uRadixWindowManager.uRadixWindowRegistry["generalErrors"+w.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=w.thisObjectName+".generalErrorsCallBack";uRadixWindowManager.uRadixWindowRegistry["generalErrors"+w.nameSpace].autoLoad.params.statusCollection=E.response.responseText;uRadixWindowManager.launch({id:"generalErrors"+w.nameSpace,key:"generalErrors"+w.nameSpace})}})}else{try{alert("internalUserFormPanel form is NOT valid")}catch(C){}}}Ext.form.Field.prototype.msgTarget="sideDetails";var d=new uRadix.form.FormPanel({title:"Add Groups & Roles",bodyBorder:true,border:true,autoScroll:true,style:"padding-top:10px;",ctCls:"support-portal-panel-frame",items:[n]});var m=new Ext.Panel({title:"Create Client User",renderTo:w.formPanelDivID,bodyBorder:false,border:false,width:1000,ctCls:"support-portal-panel",items:[{id:"idxmMirroredUserHeader",hidden:true,cls:"support-portal-panel-no-frame"},d],buttonAlign:"right",buttons:[{text:"CANCEL",ctCls:"support-portal-btn-cancel",handler:function(){idxm.core.popups.Cancel({doCancelFunction:c.doCancelFunction,noCancelFunction:function(){}})}},{id:"saveBtn"+w.nameSpace,text:"SAVE",ctCls:"support-portal-btn",handler:o}]});if(w.mirroredUser&&(w.mirroredUser!="")){var z=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");z.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,w.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}if(w.selectedGroupsArray.length){try{IDXM.Utilities.TreeBuilder(w.selectedGroupsArray,v,"Groups")}catch(r){}}else{v.expandPath(v.getRootNode().getPath())}if(w.selectedRolesArray.length){try{IDXM.Utilities.TreeBuilder(w.selectedRolesArray,b,"Roles")}catch(r){}}else{b.expandPath(b.getRootNode().getPath())}f.expandPath(f.getRootNode().getPath());var c={doCancelFunction:function(){var e=Wizard.PortalContainer.getActionURL("removeSessionDataAjax");var A=new Ext.data.Connection();A.request({url:e,method:"POST",success:function(B){var C=uRadixUtilities.jsonDecode(B.responseText);if(C.status.success){Wizard.PortalContainer.navigate({url:"clientUserStep1"})}else{Ext.Msg.alert("Status","Unable to cancel user.")}},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}})},generalErrorsCallBack:function(){Ext.getCmp("generalErrors"+w.nameSpace).close();Wizard.PortalContainer.navigate({url:Wizard.PortalContainer.getInitActionName()})},groupPickerCallBack:function(A){try{IDXM.Utilities.TreeBuilder(A.arrayOfGroups,v,"Groups")}catch(B){}Ext.getCmp("groupPicker"+w.nameSpace).close()},rolePickerPickerCallBack:function(A){try{IDXM.Utilities.TreeBuilder(A.arrayOfGroups,b,"Roles")}catch(B){}Ext.getCmp("rolePicker"+w.nameSpace).close()},ccodePickerPickerCallBack:function(A){if(A.windowObject){A.windowObject.close()}if(A.ccodeTree){var e=new Ext.tree.TreeNode({id:"ccodesTreeRootID"+w.nameSpace,text:"MultiPlan CCodes",draggable:false,leaf:false});e.appendChild(A.ccodeTree);f.setRootNode(e);f.expandPath(f.getRootNode().getPath())}}};return c};Ext.namespace("IDXM.CreateUser.InternalUser.Step1");IDXM.CreateUser.InternalUser.Step1=function(d){if(d.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilderPlain(d.breadCrumbsDivID,d.navigator.breadCrumbs)}Ext.get(document.body.id).unmask();function a(){var e=internalUserFormPanel.getForm();if(e.isValid()){var k=Wizard.PortalContainer.getActionURL("internalPersonUserValidate");var l=e.findField("personUserID").getValue();var m=e.getValues();if(m){if(m.userTypeCode==IDXM_USER_TYPE_PERSON){k=Wizard.PortalContainer.getActionURL("internalPersonUserValidate");l=e.findField("personUserID").getValue()}else{if(m.userTypeCode==IDXM_USER_TYPE_SYSTEM){k=Wizard.PortalContainer.getActionURL("internalSystemUserValidate");l=e.findField("systemUserID").getValue()}else{if(m.userTypeCode==IDXM_USER_TYPE_DEVICE){k=Wizard.PortalContainer.getActionURL("internalDeviceUserValidate");l=e.findField("deviceUserID").getValue()}}}}Ext.getCmp("nextButton").disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");e.submit({url:k,isMessageIgnore:true,success:function(o,p){g_hideStatusBox();var n=uRadixUtilities.jsonDecode(p.response.responseText).navigator;Wizard.PortalContainer.navigate({url:n.nextAction})},failure:function(p,q){var n=uRadixUtilities.jsonDecode(q.response.responseText);if(n.messages.inputFields){for(var o=0;o<n.messages.inputFields.length;o++){if(n.messages.inputFields[o].faultID=="5002"){uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.errorID="5002";uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.userID=l;uRadixWindowManager.launch({id:"notInActiveDirectory"+d.nameSpace,key:"notInActiveDirectory"+d.nameSpace})}else{if(n.messages.inputFields[o].faultID=="5003"){uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.errorID="5003";uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.userID=l;uRadixWindowManager.launch({id:"notInActiveDirectory"+d.nameSpace,key:"notInActiveDirectory"+d.nameSpace})}else{if(n.messages.inputFields[o].faultID=="5004"){uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.errorID="5004";uRadixWindowManager.uRadixWindowRegistry["notInActiveDirectory"+d.nameSpace].autoLoad.params.userID=l;uRadixWindowManager.launch({id:"notInActiveDirectory"+d.nameSpace,key:"notInActiveDirectory"+d.nameSpace})}}}}}if((n.advice!=undefined)&&(n.advice!=null)){g_showStatusBox()}Ext.getCmp("nextButton").enable();Ext.get(document.body.id).unmask()}})}}Ext.form.Field.prototype.msgTarget="sideDetails";internalUserFormPanel=new uRadix.form.FormPanel({title:"Create Internal User",ctCls:"support-portal-panel",renderTo:d.formPanelDivID,width:850,bodyBorder:false,border:false,buttonAlign:"right",items:[{xtype:"hidden",name:"userClassCode",value:IDXM_USER_CLASS_INTERNAL},{id:"idxmMirroredUserHeader",hidden:true},{xtype:"idxmUserSubClassAndTypePanel",id:"userClassAndTypePanel",ctCls:"support-portal-panel-no-frame",columnOneRadioGroup:{xtype:"radiogroup",hidden:(d.mirroredUser&&(d.mirroredUser!=""))?true:false,id:"companyTypeRadioGroup",name:"companyTypeRadioGroup",style:"padding-left:2px;padding-bottom:10px;",vertical:true,columns:1,items:[{boxLabel:"Multiplan",name:"userSubClassCode",inputValue:IDXM_USER_SUB_CLASS_MULTIPLAN,checked:true,listeners:{check:function(){b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorPanel"+d.nameSpace));b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));var e=Ext.getCmp("userTypeCodeRadioGroup");if(e){e.show()}var k=Ext.getCmp("userTypeLabel");if(k){k.show()}this.checked=true;this.checked=false;Ext.getCmp("id_cmb_prefix").focus(true)}}},{boxLabel:"HealthEOS",name:"userSubClassCode",inputValue:IDXM_USER_SUB_CLASS_HEALTHEOS,listeners:{check:function(){b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorPanel"+d.nameSpace));b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));var k=Ext.getCmp("userTypePersonRadio");if(k){k.setValue(true)}var e=Ext.getCmp("userTypeCodeRadioGroup");if(e){e.hide()}var l=Ext.getCmp("userTypeLabel");if(l){l.hide()}this.checked=true;this.checked=false;Ext.getCmp("id_cmb_prefix").focus(true)}}},{boxLabel:"Contractor",name:"userSubClassCode",inputValue:IDXM_USER_SUB_CLASS_CONSULTANT,listeners:{check:function(){b.enableShowPanel(Ext.getCmp("idxmInternalUserContractorPanel"+d.nameSpace));if(Ext.getCmp("internalUserContractorID"+d.nameSpace).getValue()==IDXM_USER_SUB_CLASS_CONTRACTOR_OTHER_DROPDOWN_ID){b.enableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace).cascade(function(m){if(m.isFormField){m.enable();m.show();m.allowBlank=false}})}else{b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace).cascade(function(m){if(m.isFormField){m.disable();m.hide();m.allowBlank=true}})}var k=Ext.getCmp("userTypePersonRadio");if(k){k.setValue(true)}var e=Ext.getCmp("userTypeCodeRadioGroup");if(e){e.hide()}var l=Ext.getCmp("userTypeLabel");if(l){l.hide()}this.checked=true;this.checked=false;Ext.getCmp("id_cmb_prefix").focus(true)}}}]},columnTwoItems:[{xtype:"label",id:"userTypeLabel",text:"User Type:",hidden:(d.mirroredUser&&(d.mirroredUser!=""))?true:false},{xtype:"radiogroup",id:"userTypeCodeRadioGroup",style:"padding-left:2px;padding-bottom:10px;",hidden:(d.mirroredUser&&(d.mirroredUser!=""))?true:false,name:"userTypeCodeRadioGroup",hideLabel:true,labelSeparator:"",vertical:true,columns:1,items:[{hideLabel:true,id:"userTypePersonRadio",boxLabel:"Person",name:"userTypeCode",inputValue:IDXM_USER_TYPE_PERSON,checked:true,listeners:{check:function(){userFields.showPanel(Ext.getCmp("idxmInternalUserPersonFieldsPanel"+d.nameSpace));this.checked=true;this.checked=false}}},{hideLabel:true,boxLabel:"System/Process",name:"userTypeCode",inputValue:IDXM_USER_TYPE_SYSTEM,listeners:{check:function(){userFields.showPanel(Ext.getCmp("idxmInternalUserSystemFieldsPanel"+d.nameSpace));this.checked=true;this.checked=false;Ext.getCmp("id_txt_sysname").focus(true)}}}]}],classDefaultSelect:"1"},{xtype:"idxmInternalUserContractorPanel",style:"padding-left:10px; padding-right:10px;",bodyStyle:"padding-left:15px;",id:"idxmInternalUserContractorPanel"+d.nameSpace,fieldId:"internalUserContractorID"+d.nameSpace,ContractorList:d.contractors},{xtype:"idxmInternalUserContractorOtherPanel",style:"padding-left:10px; padding-right:10px;",bodyStyle:"padding-left:15px;",id:"idxmInternalUserContractorOtherPanel"+d.nameSpace},{xtype:"idxmUserDatePanel",id:"userDatePanel",ctCls:"support-portal-panel-no-frame"},{xtype:"idxmInternalUserPersonFieldsPanel",id:"idxmInternalUserPersonFieldsPanel"+d.nameSpace,ctCls:"support-portal-panel-no-frame",suffixList:d.suffixes,prefixList:d.prefixes,locationList:d.locations,departmentList:d.departments,reportsToUrl:d.reportsToUrl,userData:d.userData,formObjectName:"internalUserFormPanel",isMirroredUser:(d.mirroredUser&&(d.mirroredUser!=""))?true:false},{xtype:"idxmInternalUserSystemFieldsPanel",id:"idxmInternalUserSystemFieldsPanel"+d.nameSpace,ctCls:"support-portal-panel-no-frame"},{xtype:"idxmInternalUserDeviceFieldsPanel",id:"idxmInternalUserDeviceFieldsPanel"+d.nameSpace,ctCls:"support-portal-panel-no-frame"}],buttons:[{id:"nextButton",text:"NEXT",ctCls:"support-portal-btn",handler:a}],listeners:{uradix_enterkey:a}});var h=internalUserFormPanel.getForm().findField("lastName");h.on("blur",function(){var k=internalUserFormPanel.getForm().findField("personUserID");if(k){var e=internalUserFormPanel.getForm().findField("firstName");k.setValue(e.getValue().trim()+"."+h.getValue().trim())}});if(d.mirroredUser&&(d.mirroredUser!="")){var c=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");c.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,d.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}var b=IDXM.Utilities.TogglePanels();b.setPanels([Ext.getCmp("idxmInternalUserContractorPanel"+d.nameSpace),Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace)]);b.hidePanels();Ext.getCmp("internalUserContractorID"+d.nameSpace).on("select",function(){if(this.getValue()==IDXM_USER_SUB_CLASS_CONTRACTOR_OTHER_DROPDOWN_ID){b.enableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace).cascade(function(e){if(e.isFormField){e.enable();e.show();e.allowBlank=false}})}else{b.disableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace).cascade(function(e){if(e.isFormField){e.disable();e.hide();e.allowBlank=true}})}});userFields=IDXM.Utilities.TogglePanels();userFields.setPanels([Ext.getCmp("idxmInternalUserPersonFieldsPanel"+d.nameSpace),Ext.getCmp("idxmInternalUserSystemFieldsPanel"+d.nameSpace),Ext.getCmp("idxmInternalUserDeviceFieldsPanel"+d.nameSpace)]);userFields.showPanel(Ext.getCmp("idxmInternalUserPersonFieldsPanel"+d.nameSpace));if(d.userData){try{internalUserFormPanel.getForm().setValues(d.userData);internalUserFormPanel.getForm().clearInvalid();var f=Ext.getCmp("idxmInternalUserPersonFieldsPanel"+d.nameSpace).find("hiddenName","reportsTo");if(!d.userData.reportsTo){if(f){f[0].setDisabled(true)}}else{if(d.userData.reportsToText){f[0].setValue(d.userData.reportsTo);f[0].setRawValue(d.userData.reportsToText)}}if(d.userData.contractor==IDXM_USER_SUB_CLASS_CONTRACTOR_OTHER_DROPDOWN_ID){b.enableShowPanel(Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace));Ext.getCmp("idxmInternalUserContractorOtherPanel"+d.nameSpace).cascade(function(e){if(e.isFormField){e.enable();e.show();e.allowBlank=false}})}}catch(g){Ext.Msg.alert("Status","Form Data did not Load")}}};Ext.namespace("IDXM.CreateUser.InternalUser.Step2");IDXM.CreateUser.InternalUser.Step2=function(b){Ext.get(document.body.id).unmask();var t;var h;if(b.userData){if(b.userData.userTypeCode==IDXM_USER_TYPE_PERSON){t=IDXM.internalPersonUserTemplate(b.userData);h=IDXM_USER_TYPE_PERSON}else{if(b.userData.userTypeCode==IDXM_USER_TYPE_SYSTEM){t=IDXM.internalSystemUserTemplate(b.userData);h=IDXM_USER_TYPE_SYSTEM}else{if(b.userData.userTypeCode==IDXM_USER_TYPE_DEVICE){t=IDXM.internalDeviceUserTemplate(b.userData);h=IDXM_USER_TYPE_DEVICE}}}}if(b.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilder(b.breadCrumbsDivID,b.navigator.breadCrumbs)}var d=new Ext.Panel({bodyBorder:false,border:false,style:"padding-left:10px;",frame:false,width:300,height:404,autoScroll:true,html:t});var k=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Name & Information"},{xtype:"tbfill"}]});var r=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Groups"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(b.mirroredUser&&(b.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["groupPicker"+b.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=b.thisObjectName+".groupPickerCallBack";uRadixWindowManager.launch({id:"groupPicker"+b.nameSpace,key:"groupPicker"+b.nameSpace})}}]});var o=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Roles"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(b.mirroredUser&&(b.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["rolePicker"+b.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=b.thisObjectName+".rolePickerPickerCallBack";uRadixWindowManager.launch({id:"rolePicker"+b.nameSpace,key:"rolePicker"+b.nameSpace})}}]});var n=new Ext.tree.TreeNode({id:"groupsTreeRootID"+b.nameSpace,text:"Groups",draggable:false,leaf:false});if(b.defaultGroups){n.appendChild(b.defaultGroups)}var s=new Ext.tree.TreePanel({id:"ViewTtreePanelGroupID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,autoScroll:true,width:245,height:400,autoShow:true,rootVisible:false,containerScroll:true,root:n});var q=new Ext.tree.TreeNode({id:"rolessTreeRootID"+b.nameSpace,text:"Roles",draggable:false,leaf:false});if(b.defaultRoles){q.appendChild(b.defaultRoles)}var g=new Ext.tree.TreePanel({id:"ViewTtreePanelRoleID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,autoScroll:true,height:400,width:245,autoShow:true,rootVisible:false,containerScroll:true,selModel:new Ext.tree.MultiSelectionModel({}),root:q});var c=new Ext.Panel({layout:"column",bodyBorder:false,border:false,hideBorders:true,width:840,style:"padding-top:10px; padding-bottom:10px;",ctCls:"support-portal-panel-head-frame",items:[{width:10,html:"&nbsp;"},{width:310,ctCls:"support-portal-panel-head-frame",items:[k,d]},{width:10,html:"&nbsp;"},{width:510,ctCls:"support-portal-panel-head-frame",items:[{xtype:"panel",layout:"column",items:[{width:250,items:[r,s]},{width:10,html:"&nbsp;"},{width:250,items:[o,g]}]}]},{width:10,html:"&nbsp;"}]});function p(){var e=a.getForm();if(e.isValid()){var u=Wizard.PortalContainer.getActionURL("userCreateSubmit");var v=e.getValues();Ext.getCmp("saveBtn"+b.nameSpace).disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");e.submit({url:u,isMessageIgnore:true,isRedirect:true,success:function(y,z){var w=uRadixUtilities.jsonDecode(z.response.responseText);if(w.payload&&w.payload!="null"){var x=uRadixUtilities.jsonDecode(w.payload);uRadixRedirectHandler.redirect(b.userProfileAdministrationURL+"?systemUserId="+x.primaryIdentityIdentifier.sysKey+"&fromUserCreate=true")}},failure:function(w,x){Ext.getCmp("saveBtn"+b.nameSpace).enable();Ext.get(document.body.id).unmask();uRadixWindowManager.uRadixWindowRegistry["generalErrors"+b.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=b.thisObjectName+".generalErrorsCallBack";uRadixWindowManager.uRadixWindowRegistry["generalErrors"+b.nameSpace].autoLoad.params.statusCollection=x.response.responseText;uRadixWindowManager.launch({id:"generalErrors"+b.nameSpace,key:"generalErrors"+b.nameSpace})}})}}Ext.form.Field.prototype.msgTarget="sideDetails";var a=new uRadix.form.FormPanel({title:"Add Groups & Roles",bodyBorder:true,border:true,autoScroll:true,style:"padding-top:10px;",ctCls:"support-portal-panel-frame",items:[c]});var f=new Ext.Panel({title:"Create Internal User",renderTo:"internalStep2DIV"+b.nameSpace,bodyBorder:false,border:false,width:850,ctCls:"support-portal-panel",items:[{id:"idxmMirroredUserHeader",hidden:true,cls:"support-portal-panel-no-frame"},a],buttonAlign:"right",buttons:[{text:"CANCEL",ctCls:"support-portal-btn-cancel",handler:function(){idxm.core.popups.Cancel({doCancelFunction:jsonFunctionObject.doCancelFunction,noCancelFunction:function(){}})}},{id:"saveBtn"+b.nameSpace,text:"SAVE",ctCls:"support-portal-btn",handler:p}]});if(b.mirroredUser&&(b.mirroredUser!="")){var l=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");l.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,b.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}if(b.selectedGroupsArray.length){try{IDXM.Utilities.TreeBuilder(b.selectedGroupsArray,s,"Groups")}catch(m){}}else{s.expandPath(s.getRootNode().getPath())}if(b.selectedRolesArray.length){try{IDXM.Utilities.TreeBuilder(b.selectedRolesArray,g,"Roles")}catch(m){}}else{g.expandPath(g.getRootNode().getPath())}return jsonFunctionObject={doCancelFunction:function(){var e=Wizard.PortalContainer.getActionURL("removeSessionDataAjax");var u=new Ext.data.Connection();u.request({url:e,method:"POST",success:function(v){var w=uRadixUtilities.jsonDecode(v.responseText);if(w.status.success){Wizard.PortalContainer.navigate({url:"clientUserStep1"})}else{Ext.Msg.alert("Status","Unable to cancel user.")}},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}})},generalErrorsCallBack:function(){Ext.getCmp("generalErrors"+b.nameSpace).close();Wizard.PortalContainer.navigate({url:Wizard.PortalContainer.getInitActionName()})},groupPickerCallBack:function(u){try{IDXM.Utilities.TreeBuilder(u.arrayOfGroups,s,"Groups")}catch(v){}Ext.getCmp("groupPicker"+b.nameSpace).close()},rolePickerPickerCallBack:function(u){try{IDXM.Utilities.TreeBuilder(u.arrayOfGroups,g,"Roles")}catch(v){}Ext.getCmp("rolePicker"+b.nameSpace).close()}};return jsonFunctionObject};Ext.namespace("IDXM.LikeUsersStep");IDXM.LikeUsersStep=Ext.extend(Ext.Panel,{cancelUser:function(b){if(b){Ext.getCmp("cancelUser<portlet:namespace/>").close();var a=new Ext.data.Connection();a.request({url:Wizard.PortalContainer.getActionURL("removeSessionDataAjax"),method:"POST",success:function(c){Wizard.PortalContainer.navigate({url:Wizard.PortalContainer.getInitActionName()})},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}})}else{Ext.getCmp("cancelUser<portlet:namespace/>").close()}},viewUserWindow:function(a){return"<a class='edit-icon' href='javascript:launchUserProfileWindow(\""+a+"\")'><div class='edit-icon'>&nbsp;</div></a>"},launchUserProfileWindow:function(a){window.open("<%=userProfileAdministrationURL%>?systemUserId="+a,"User Profile Admin","status=1,toolbar=1,height=500,width=600")},initComponent:function(){var LikeUsersStepObject=this.LikeUsersStepObject;var templateString;var store;var colModel;var sm=new Ext.ux.grid.RadioSelectionModel({singleSelect:true,width:25});if(this.userData&&this.likeUsersList){if(this.userData.userTypeCode==IDXM_USER_TYPE_PERSON){var likeUsersArray=new Array();for(i=0;i<this.likeUsersList.length;i++){likeUsersArray[i]={};likeUsersArray[i]["id"]=this.likeUsersList[i].primaryIdentityIdentifier.sysKey;likeUsersArray[i]["name"]=this.likeUsersList[i].firstName+" "+this.likeUsersList[i].lastName;for(j=0;j<this.likeUsersList[i].contactDetails.emailList.length;j++){if(this.likeUsersList[i].contactDetails.emailList[j].primary){likeUsersArray[i]["email"]=this.likeUsersList[i].contactDetails.emailList[j].emailAddress}}if(this.userData.userClassCode==IDXM_USER_CLASS_INTERNAL){likeUsersArray[i]["location"]=this.likeUsersList[i].location.locationName;likeUsersArray[i]["department"]=this.likeUsersList[i].department.departmentName}likeUsersArray[i]["status"]=this.likeUsersList[i].primaryIdentityStatus.statusName;likeUsersArray[i]["userClassCode"]=this.likeUsersList[i].userClassCode;likeUsersArray[i]["userTypeCode"]=this.likeUsersList[i].userTypeCode}likeUsersJson={data:likeUsersArray};if(this.userData.userClassCode==IDXM_USER_CLASS_INTERNAL){templateString=IDXM.internalPersonUserTemplate(this.userData);colModel=new Ext.grid.ColumnModel({columns:[sm,{id:"name",header:"Name",sortable:true,dataIndex:"name"},{header:"Location",sortable:true,dataIndex:"location"},{header:"Department",sortable:true,dataIndex:"department"},{header:"Status",sortable:true,dataIndex:"status"},{header:"",sortable:true,dataIndex:"id",renderer:eval(LikeUsersStepObject.viewUserWindow)}],defaults:{sortable:true,menuDisabled:true}});store=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"data",totalProperty:"totalCount",idProperty:"id",fields:["id","name","location","department","status","userClassCode","userTypeCode"]}),data:likeUsersJson})}if(this.userData.userClassCode==IDXM_USER_CLASS_CLIENT){templateString=IDXM.clientSingleUserTemplate(this.userData);colModel=new Ext.grid.ColumnModel({columns:[sm,{id:"name",header:"Name",sortable:true,dataIndex:"name"},{header:"Email",sortable:true,dataIndex:"email"},{header:"Status",sortable:true,dataIndex:"status"},{header:"",sortable:true,dataIndex:"id",renderer:eval(LikeUsersStepObject.viewUserWindow)}],defaults:{sortable:true,menuDisabled:true}});store=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"data",totalProperty:"totalCount",idProperty:"id",fields:["id","name","email","status","userClassCode","userTypeCode"]}),data:likeUsersJson})}if(this.userData.userClassCode==IDXM_USER_CLASS_VENDOR){templateString=IDXM.vendorSingleUserTemplate(this.userData);colModel=new Ext.grid.ColumnModel({columns:[sm,{id:"name",header:"Name",sortable:true,dataIndex:"name"},{header:"Email",sortable:true,dataIndex:"email"},{header:"Status",sortable:true,dataIndex:"status"},{header:"",sortable:true,dataIndex:"id",renderer:eval(LikeUsersStepObject.viewUserWindow)}],defaults:{sortable:true,menuDisabled:true}});store=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"data",totalProperty:"totalCount",idProperty:"id",fields:["id","name","email","status","userClassCode","userTypeCode"]}),data:likeUsersJson})}}}Ext.apply(this,{border:false,bodyBorder:false,hideBorders:true,bodyStyle:"padding:5px;",items:[{xtype:"panel",border:false,bodyBorder:false,hideBorders:true,items:[{xtype:"idxmStatusBox",status:"warning",statusText:this.statusText},{xtype:"panel",height:8,border:0,style:"boder:none;",bodyBorder:0,bodyStyle:"border:none",hideBorders:true},{xtype:"panel",bodyBorder:false,border:false,hideBorders:true,autoScroll:true,style:"padding-left:10px; padding-right:10px;",html:this.htmlText},{xtype:"panel",layout:"column",bodyBorder:false,border:false,hideBorders:true,frame:false,style:"padding-left:10px; padding-right:10px;",ctCls:"idxmPanel",items:[{columnWidth:0.69,style:"border:1px; border-style:solid; border-color:#dddddd; padding-top:10px; padding-left:20px; padding-right:20px; padding-bottom:10px;",items:[{xtype:"idxmLikeUsersGrid",id:"likeUserGrid<portlet:namespace/>",title:"<b>Like Users</b>",colModel:colModel,store:store,width:530,height:450,autoScroll:true,buttonAlign:"right",buttons:[{text:"CANCEL",type:"button",handler:function(){uRadixWindowManager.launch({id:"cancelUser<portlet:namespace/>",key:"cancelUser<portlet:namespace/>"})},ctCls:"support-portal-btn-cancel"},{text:"CONTINUE WITH SELECTED USER",type:"button",handler:function(){var getSelectedRecord=Ext.getCmp("likeUserGrid<portlet:namespace/>").getSelectionModel().getSelected();if(getSelectedRecord){var userClassCode=getSelectedRecord.data.userClassCode;var userTypeCode=getSelectedRecord.data.userTypeCode;var systemUserId=getSelectedRecord.id;var conn=new Ext.data.Connection();conn.request({url:Wizard.PortalContainer.getActionURL("removeSessionDataAjax"),method:"POST",success:function(responseObject){uRadixCookieManager.createCookie(uRadixCookieManager.MPI_COOKIE_NAME+"systemUserId",systemUserId,1);uRadixRedirectHandler.redirect("<%=userProfileAdministrationURL%>?systemUserId="+systemUserId)},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}})}else{Ext.MessageBox.alert("Status","Please select a Like User.")}},ctCls:"support-portal-btn"}]}]},{columnWidth:0.01,html:"&nbsp"},{columnWidth:0.3,style:"border:1px; border-style:solid; border-color:#dddddd; padding-top:10px; padding-left:20px; padding-right:20px; padding-bottom:10px;",items:[{title:"<b>New User</b>",width:"auto",height:450,html:templateString,bodyStyle:"padding-left:15px; padding-right:15px; background-color:#eeeeee;",buttonAlign:"right",buttons:[{text:"CONTINUE WITH NEW USER",type:"button",handler:function(){var conn=new Ext.data.Connection();conn.request({url:Wizard.PortalContainer.getActionURL("likeUserContinue"),method:"POST",success:function(responseObject){var statusCollection=uRadixUtilities.jsonDecode(responseObject.responseText);if(!statusCollection.status.success){Ext.Msg.alert("Status","Unable to Set Like Users Continue.")}},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}});if(this.userData.userClassCode==IDXM_USER_CLASS_INTERNAL){Wizard.PortalContainer.navigate({url:"internalUserStep2"})}else{if(this.userData.userClassCode==IDXM_USER_CLASS_CLIENT){Wizard.PortalContainer.navigate({url:"clientUserStep2"})}else{if(this.userData.userClassCode==IDXM_USER_CLASS_VENDOR){Wizard.PortalContainer.navigate({url:"vendorUserStep2"})}}}},ctCls:"support-portal-btn"}]}]}]}]}]});Ext.apply(this.initialConfig,{layout:this.layout,style:this.style,bodyBorder:this.bodyBorder,border:this.border,width:this.width,items:this.items});IDXM.LikeUsersStep.superclass.initComponent.call(this)}});Ext.reg("IDXM-LikeUsersStep",IDXM.LikeUsersStep);Ext.namespace("IDXM.CreateUser.VendorUser.Step1");IDXM.CreateUser.VendorUser.Step1=function(e){if(e.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilderPlain(e.breadCrumbsDivID,e.navigator.breadCrumbs)}Ext.get(document.body.id).unmask();function b(){var f=d.getForm();if(f.isValid()){var h=d.find("name","userNameToMirror");if(!h[0].isDirty()){h[0].disable()}Ext.getCmp("nextButton").disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");var g=Wizard.PortalContainer.getActionURL("vendorUserValidate");f.submit({url:g,isMessageIgnore:true,success:function(l,m){g_hideStatusBox();var k=uRadixUtilities.jsonDecode(m.response.responseText).navigator;Wizard.PortalContainer.navigate({url:k.nextAction})},failure:function(n,o){var l=uRadixUtilities.jsonDecode(o.response.responseText);if(l.messages.inputFields){for(var m=0;m<l.messages.inputFields.length;m++){if(l.messages.inputFields[m].fieldID=="likeUsersList"){var k=l.navigator;Wizard.PortalContainer.navigate({url:k.nextAction})}}}if((l.advice!=undefined)&&(l.advice!=null)){g_showStatusBox()}h[0].enable();Ext.getCmp("nextButton").enable();Ext.get(document.body.id).unmask()}})}}Ext.form.Field.prototype.msgTarget="sideDetails";var d=new uRadix.form.FormPanel({title:"Create Vendor User",renderTo:e.formPanelDivID,ctCls:"support-portal-panel",width:850,bodyBorder:false,border:false,buttonAlign:"right",items:[{xtype:"hidden",name:"userClassCode",value:IDXM_USER_CLASS_VENDOR},{id:"idxmMirroredUserHeader",hidden:true},{xtype:"idxmUserSubClassAndTypePanel",ctCls:"support-portal-panel-no-frame",style:"padding-top:5px",columnOneRadioGroup:{xtype:"radiogroup",id:"userSubClassRadionGroup",name:"userSubClassRadionGroup",style:"padding-left:2px;padding-bottom:10px;",hideLabel:true,hidden:(e.mirroredUser&&(e.mirroredUser!=""))?true:false,labelSeparator:"",vertical:true,columns:1,items:[{boxLabel:"Service Provider",name:"userSubClassCode",inputValue:IDXM_USER_SUB_CLASS_VENDOR_SERVICE_PROVIDER,checked:true,listeners:{check:function(){a.showPanel(Ext.getCmp("vendorServiceProviderDropDown"+e.nameSpace));this.checked=true;this.checked=false;Ext.getCmp("id_cmb_providername").focus(true)}}},{boxLabel:"Operational",name:"userSubClassCode",inputValue:IDXM_USER_SUB_CLASS_VENDOR_OPERATIONAL,listeners:{check:function(){a.showPanel(Ext.getCmp("vendorOperationalDropDown"+e.nameSpace));this.checked=true;this.checked=false;Ext.getCmp("id_cmb_vendorname").focus(true)}}}]}},{xtype:"idxmUserDatePanel",id:"idxmUserDatePanel"+e.nameSpace,width:850,ctCls:"support-portal-panel-no-frame"},{xtype:"idxmVendorServiceProviderDropDown",id:"vendorServiceProviderDropDown"+e.nameSpace,serviceProviders:e.serviceProviders,isMirroredUser:(e.mirroredUser&&(e.mirroredUser!=""))?true:false},{xtype:"idxmVendorOperationalDropDown",id:"vendorOperationalDropDown"+e.nameSpace,operationalVendors:e.operationalVendors,isMirroredUser:(e.mirroredUser&&(e.mirroredUser!=""))?true:false},{xtype:"idxmVendorMirrorUserPanel",id:"idxmVendorMirrorUserPanel"+e.nameSpace,hidden:(e.mirroredUser&&(e.mirroredUser!=""))?true:false},{xtype:"idxmVendorFieldsPanel",id:"idxmVendorFieldsPanel"+e.nameSpace}],buttons:[{id:"nextButton",text:"NEXT",ctCls:"support-portal-btn",handler:b}],listeners:{uradix_enterkey:b}});var a=IDXM.Utilities.TogglePanels();a.setPanels([Ext.getCmp("vendorOperationalDropDown"+e.nameSpace),Ext.getCmp("vendorServiceProviderDropDown"+e.nameSpace)]);a.showPanel(Ext.getCmp("vendorServiceProviderDropDown"+e.nameSpace));if(e.userData){d.getForm().setValues(e.userData);d.getForm().clearInvalid()}if(e.mirroredUser&&(e.mirroredUser!="")){var c=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");c.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,e.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}};Ext.namespace("IDXM.CreateUser.VendorUser.Step2");IDXM.CreateUser.VendorUser.Step2=function(s){var d=IDXM.vendorSingleUserTemplate(s.userData);var n=IDXM_USER_CLASS_VENDOR;if(s.navigator.breadCrumbs){IDXM.Utilities.BreadCrumbBuilder(s.breadCrumbsDivID,s.navigator.breadCrumbs)}Ext.get(document.body.id).unmask();var f=new Ext.Panel({bodyBorder:false,border:false,style:"padding-left:10px;",frame:false,autoScroll:true,width:300,height:404,html:d});var g=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Name & Information"},{xtype:"tbfill"}]});var p=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Groups"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(s.mirroredUser&&(s.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["groupPicker"+s.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=s.thisObjectName+".groupPickerCallBack";uRadixWindowManager.launch({id:"groupPicker"+s.nameSpace,key:"groupPicker"+s.nameSpace})}}]});var a=new Ext.Toolbar({ctCls:"toolbar-portal-panel-head-frame",autoheight:true,items:[{xtype:"tbtext",text:"Roles"},{xtype:"tbfill"},{xtype:"tbbutton",iconCls:"edit-icon",text:"",hidden:(s.mirroredUser&&(s.mirroredUser!=""))?true:false,handler:function(){uRadixWindowManager.uRadixWindowRegistry["rolePicker"+s.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=s.thisObjectName+".rolePickerPickerCallBack";uRadixWindowManager.launch({id:"rolePicker"+s.nameSpace,key:"rolePicker"+s.nameSpace})}}]});var m=new Ext.tree.TreeNode({id:"groupsTreeRootID"+s.nameSpace,text:"Groups",draggable:false,leaf:false});if(s.defaultGroups){m.appendChild(s.defaultGroups)}var r=new Ext.tree.TreePanel({id:"ViewTreePanelGroupID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,autoScroll:true,width:235,height:400,autoShow:true,rootVisible:false,containerScroll:true,root:m});var t=new Ext.tree.TreeNode({id:"rolessTreeRootID"+s.nameSpace,text:"Roles",draggable:false,leaf:false});if(s.defaultRoles){t.appendChild(s.defaultRoles)}var b=new Ext.tree.TreePanel({id:"ViewTtreePanelRoleID",frame:false,ctCls:"tree-portal-node-no-icon",useArrows:true,autoScroll:true,width:235,height:400,autoShow:true,rootVisible:false,containerScroll:true,root:t});var h=new Ext.Panel({layout:"column",bodyBorder:false,border:false,hideBorders:true,width:840,style:"padding-top:10px; padding-bottom:10px;",ctCls:"support-portal-panel-head-frame",items:[{width:10,html:"&nbsp;"},{width:310,ctCls:"support-portal-panel-head-frame",items:[g,f]},{width:10,html:"&nbsp;"},{width:510,ctCls:"support-portal-panel-head-frame",items:[{xtype:"panel",layout:"column",autoScroll:true,items:[{width:250,items:[p,r]},{width:5,html:"&nbsp;"},{width:250,items:[a,b]}]}]},{width:10,html:"&nbsp;"}]});function l(){var e=o.getForm();if(e.isValid()){var v=Wizard.PortalContainer.getActionURL("userCreateSubmit");var w=e.getValues();Ext.getCmp("saveBtn"+s.nameSpace).disable();Ext.get(document.body.id).mask("<b> Loading...</b> ","x-mask-loading");e.submit({url:v,isMessageIgnore:true,isRedirect:true,success:function(z,A){var x=uRadixUtilities.jsonDecode(A.response.responseText);if(x.payload&&x.payload!="null"){var y=uRadixUtilities.jsonDecode(x.payload);uRadixRedirectHandler.redirect(s.userProfileAdministrationURL+"?systemUserId="+y.primaryIdentityIdentifier.sysKey+"&fromUserCreate=true")}},failure:function(x,y){Ext.getCmp("saveBtn"+s.nameSpace).enable();Ext.get(document.body.id).unmask();uRadixWindowManager.uRadixWindowRegistry["generalErrors"+s.nameSpace].autoLoad.params[uRadixWindowManager.MPI_CALLBACK_NAME]=s.thisObjectName+".generalErrorsCallBack";uRadixWindowManager.uRadixWindowRegistry["generalErrors"+s.nameSpace].autoLoad.params.statusCollection=y.response.responseText;uRadixWindowManager.launch({id:"generalErrors"+s.nameSpace,key:"generalErrors"+s.nameSpace})}})}}Ext.form.Field.prototype.msgTarget="sideDetails";var o=new uRadix.form.FormPanel({title:"Add Groups & Roles",bodyBorder:true,border:true,autoScroll:true,style:"padding-top:10px;",ctCls:"support-portal-panel-frame",items:[h]});var k=new Ext.Panel({title:"Create Vendor User",renderTo:s.formPanelDivID,bodyBorder:false,border:false,width:850,ctCls:"support-portal-panel",items:[{id:"idxmMirroredUserHeader",hidden:true,cls:"support-portal-panel-no-frame"},o],buttonAlign:"right",buttons:[{text:"CANCEL",ctCls:"support-portal-btn-cancel",handler:function(){idxm.core.popups.Cancel({doCancelFunction:c.doCancelFunction,noCancelFunction:function(){}})}},{id:"saveBtn"+s.nameSpace,text:"SAVE",ctCls:"support-portal-btn",handler:l}]});if(s.mirroredUser&&(s.mirroredUser!="")){var u=new Ext.XTemplate('<div style="background-color:#ffffcc; height:25px; margin-top:6px; padding-top:8px;">&nbsp;&nbsp;Mirroring User: ',"<b>{firstName} {lastName}</b>","</div>");u.overwrite(Ext.getCmp("idxmMirroredUserHeader").body,s.mirroredUser);Ext.getCmp("idxmMirroredUserHeader").show()}if(s.selectedGroupsArray.length){try{IDXM.Utilities.TreeBuilder(s.selectedGroupsArray,r,"Groups")}catch(q){}}else{r.expandPath(r.getRootNode().getPath())}if(s.selectedRolesArray.length){try{IDXM.Utilities.TreeBuilder(s.selectedRolesArray,b,"Roles")}catch(q){}}else{b.expandPath(b.getRootNode().getPath())}var c={doCancelFunction:function(){var e=Wizard.PortalContainer.getActionURL("removeSessionDataAjax");var v=new Ext.data.Connection();v.request({url:e,method:"POST",success:function(w){var x=uRadixUtilities.jsonDecode(w.responseText);if(x.status.success){Wizard.PortalContainer.navigate({url:"clientUserStep1"})}else{Ext.Msg.alert("Status","Unable to cancel user.")}},failure:function(){Ext.Msg.alert("Status","Unable to reset session data.")}})},generalErrorsCallBack:function(){Ext.getCmp("generalErrors"+s.nameSpace).close();Wizard.PortalContainer.navigate({url:Wizard.PortalContainer.getInitActionName()})},groupPickerCallBack:function(v){try{IDXM.Utilities.TreeBuilder(v.arrayOfGroups,r,"Groups")}catch(w){}Ext.getCmp("groupPicker"+s.nameSpace).close()},rolePickerPickerCallBack:function(v){try{IDXM.Utilities.TreeBuilder(v.arrayOfGroups,b,"Roles")}catch(w){}Ext.getCmp("rolePicker"+s.nameSpace).close()}};return c};